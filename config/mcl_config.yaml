# Unified MCL Configuration
# Supports both real hardware and simulation modes
particle_filter:
  ros__parameters:
    # === CORE PARAMETERS ===
    max_particles: 4000                # Number of particles
    max_viz_particles: 60              # Particles shown in RViz
    max_range: 12.0                    # Maximum laser range (m)
    max_pose_range: 10000.0           # Maximum valid pose coordinate range (m)
    
    # === MODE CONFIGURATION ===
    sim_mode: false                    # Set to true for simulation
    
    # === MOTION MODEL NOISE ===
    motion_dispersion_x: 0.05          # Forward motion noise (m)
    motion_dispersion_y: 0.025         # Lateral motion noise (m)
    motion_dispersion_theta: 0.25      # Rotation noise (rad)
    
    # === ROBOT GEOMETRY ===
    # Real hardware values (overridden in sim_mode)
    lidar_offset_x: 0.288              # LiDAR forward offset from base_link (m)
    lidar_offset_y: 0.0                # LiDAR lateral offset from base_link (m)
    wheelbase: 0.325                   # Distance between axles (m)
    
    # === SENSOR MODEL (4-component beam model) ===
    z_hit: 0.80                        # Weight for correct measurements
    z_short: 0.01                      # Weight for unexpected obstacles
    z_max: 0.07                        # Weight for max range readings
    z_rand: 0.12                       # Weight for random noise
    sigma_hit: 8.0                     # Measurement noise std dev
    
    # === RAY CASTING ===
    range_method: "cddt"               # Distance transform method
    theta_discretization: 112          # Angular resolution
    rangelib_variant: 2                # Ray casting variant
    angle_step: 18                     # Laser downsampling factor
    squash_factor: 2.2                 # Weight normalization
    use_parallel_raycasting: true      # Enable parallel processing
    num_threads: 0                     # Auto-detect threads
    
    # === ROS TOPICS ===
    # Default values (overridden based on sim_mode in launch file)
    scan_topic: "/scan"                # LaserScan input
    odom_topic: "/odom"                # Odometry input
    
    # === PUBLISHING OPTIONS ===
    publish_odom: true                 # Publish pose as odometry
    viz: true                          # Enable visualization
    timer_frequency: 100.0             # Update frequency (Hz)
    
    # === PERFORMANCE ===
    fine_timing: 0                     # Debug timing (0=off, 1=on)
    
    # === TF FRAMES ===
    map_frame: "map"                   # Global reference frame
    base_frame: "base_link"            # Robot base frame
    laser_frame: "laser"               # Laser scanner frame

# Map server configuration
map_server:
  ros__parameters:
    # Default map (can be overridden via launch argument)
    map: 'sibal1'                      # Map name without .yaml extension